<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hello, World! | Tiexin Guo</title><meta name=keywords content="devstream"><meta name=description content="Hello, and welcome to the DevStream blog! In this very first &ldquo;hello world&rdquo; post, I will: give you a high-level picture of how DevStream functions; walk you through our codebase; explain briefly how to create your own plugin. If you haven&rsquo;t heard of DevStream yet, please have a quick glance over our README. Without further adieu, let&rsquo;s get started. TL;DR Too bad, there isn&rsquo;t one. But don&rsquo;t close the tab"><meta name=author content="Tiexin Guo | 郭铁心"><link rel=canonical href=https://www.guotiexin.com/posts/hello-world/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.guotiexin.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.guotiexin.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.guotiexin.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.guotiexin.com/apple-touch-icon.png><link rel=mask-icon href=https://www.guotiexin.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Hello, World!"><meta property="og:description" content="Hello, and welcome to the DevStream blog! In this very first &ldquo;hello world&rdquo; post, I will: give you a high-level picture of how DevStream functions; walk you through our codebase; explain briefly how to create your own plugin. If you haven&rsquo;t heard of DevStream yet, please have a quick glance over our README. Without further adieu, let&rsquo;s get started. TL;DR Too bad, there isn&rsquo;t one. But don&rsquo;t close the tab"><meta property="og:type" content="article"><meta property="og:url" content="https://www.guotiexin.com/posts/hello-world/"><meta property="og:image" content="https://www.guotiexin.com/donganlake.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-21T00:00:00+00:00"><meta property="article:modified_time" content="2022-03-21T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.guotiexin.com/donganlake.jpg"><meta name=twitter:title content="Hello, World!"><meta name=twitter:description content="Hello, and welcome to the DevStream blog! In this very first &ldquo;hello world&rdquo; post, I will: give you a high-level picture of how DevStream functions; walk you through our codebase; explain briefly how to create your own plugin. If you haven&rsquo;t heard of DevStream yet, please have a quick glance over our README. Without further adieu, let&rsquo;s get started. TL;DR Too bad, there isn&rsquo;t one. But don&rsquo;t close the tab"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.guotiexin.com/posts/"},{"@type":"ListItem","position":3,"name":"Hello, World!","item":"https://www.guotiexin.com/posts/hello-world/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hello, World!","name":"Hello, World!","description":"Hello, and welcome to the DevStream blog! In this very first \u0026ldquo;hello world\u0026rdquo; post, I will: give you a high-level picture of how DevStream functions; walk you through our codebase; explain briefly how to create your own plugin. If you haven\u0026rsquo;t heard of DevStream yet, please have a quick glance over our README. Without further adieu, let\u0026rsquo;s get started. TL;DR Too bad, there isn\u0026rsquo;t one. But don\u0026rsquo;t close the tab","keywords":["devstream"],"articleBody":"Hello, and welcome to the DevStream blog!\nIn this very first “hello world” post, I will:\ngive you a high-level picture of how DevStream functions; walk you through our codebase; explain briefly how to create your own plugin. If you haven’t heard of DevStream yet, please have a quick glance over our README.\nWithout further adieu, let’s get started.\nTL;DR Too bad, there isn’t one. But don’t close the tab right away; let me tell you a story.\nMost of the time, I’m a “normal” end-user. And by “normal”, I mean I don’t bother myself with creating GitHub issues and pull requests and follow the updates for days (if not weeks). I love and use open-source projects, but that’s about it. Perhaps when I’m in an extremely good (or bad) mood, I will open up a discussion to give some feedback (or WTFs) and ramble about it. I don’t really contribute on a daily basis, though. Don’t get me wrong: I’d love it if I had more time; but I work a 9-to-5 job to live, just like most of the readers do.\nIf you are like me, should you read this post anyway?\nWell, yes. Because although this article is about DevStream, it isn’t. We will cover quite some topics that are non-specific to DevStream. We will discuss generic topics about life, the universe, and everything. Hang tight. Here we go.\nCriticism Wanted We released early (Mar 2nd, 2022.) Maybe a little bit too early, one would say. We weren’t in stealth mode for long; 8 weeks, tops.\nOf course, that wasn’t a mistake. We didn’t accidentally click the “publish” button on Product Hunt and leak it out. We did this pretty much on purpose. In fact, even before our version 0.1 was released, we had already decided to aim for an early release. It’s pretty much by design. Since it’s still early and immature, there might be bugs. I know you probably want to swear already, but bear with me:\nI mean, technically, we could work on it for a much longer period, polish it up, add more features, support more tools, and what have you. But in that case, we might end up with something we thought is perfect but utterly useless to you, which is what really matters.\nAll we had was an idea. We didn’t know “how”, or even “what”. All we knew is, we wanted to build something that is useful for the end-users. So why not release it to the users and ask them to tell us what to build and how to build?\nThe idea isn’t mine, though. It would be arrogant if I said that I invented that. In fact, I learned it from lean manufacturing and agile development. To be honest, if I learned only one thing from lean manufacturing and agile, it’s that we should reduce the product-to-customer cycle. It’s The Toyota Way.\nOK, enough rambling. If you are interested in DevStream, simply go to our GitHub repo, follow our README and quickstart, and have a go. I’m sure you will have some “WTF” moments during your first try, in which case, don’t hesitate to head to our GitHub Issues page and hit the “New Issue” button hard. We have prepared a few templates there to help you quickly get your dissatisfaction out of your system. Heck, you can even create an issue about the issue templates themselves. For helpful contributions, we will give you a “good first issue” label and who knows, probably the marketing team will reach out and award you with a little physical prize as well!\nIntrigued? Then let’s dive a little deeper into it.\nArchitecture A picture is worth a thousand words:\nWe use the Go plugin. I know this is kind of a big topic so here I’m only going to talk about it briefly:\nFirst of all, we want to support many DevOps tools, and one tool corresponding to one plugin sounds natural. Second of all, although there are other ways to do the “core-plugin” architecture, we reviewed Go’s plugin and it met our needs. Oops, I thought there was a “third” or “last but not least”, but there isn’t. Sorry. State We consider DevStream (CLI tool dtm, don’t ask me why; it’s another whole story. Read this if you enjoy stories) as a “state machine”.\nSimply put, given input and the current state, DevStream will calculate what to do, so that “what you want” (what you described in the input) is “what you get”.\nIf you are interested, read more here.\nDirectory structure We follow Golang’s standard project layout. But don’t click that link, it’s too long and too verbose and contains probably many things you don’t immediately need right now. Continue to read the TL;DR version:\n/cmd: main applications for this project. Don’t put a lot of code in the application directory. If you think the code can be imported and used in other projects, then it should live in the /pkg directory. If the code is not reusable or if you don’t want others to reuse it, put that code in the /internal directory. /pkg: library code that’s ok to use by external apps. Other projects will import these libs expecting them to work, so think twice before you put something here. /internal: private application and library code; things you don’t want others to import in their own apps. /hack: contains many scripts that ensure continuous development of DevStream. We didn’t invent this; we simply stole Kubernetes’ idea. /build: packaging and CI-related stuff. /docs: pretty much self-explanatory. Need I say more? /examples: examples for your apps or public libs. Here we use it to store some sample configurations. Of course, this isn’t the only way to set up a repo structure for a Golang app. If you are a beginner, though, this can save you some time. For example, after reading this, you should know that if you want to find the entrance of the app, you shall look into the cmd folder. That’s where the main app lives.\nCore / Plugin Core code: https://github.com/devstream-io/devstream/tree/main/internal/pkg/pluginengine Plugins Code: https://github.com/devstream-io/devstream/tree/main/internal/pkg/plugin How Exactly Does dtm apply Work? Is it “Automatic”, or “Automagic”? It all starts with /cmd/devstream/main.go. It executes the apply command in /cmd/devstream/apply.go. The Engine /internal/pkg/pluginengine runs the logic for apply at /internal/pkg/pluginengine/cmd_apply.go. Then, happy digging around in the “Apply” function!\nYou Release Waaaaay Too Slow! I WANT THE LATEST STUFF!! NOW!!! Alright, alright, here you go.\nFirst, install Go. If you haven’t done so, please refer to the official doc here.\ngit clone https://github.com/devstream-io/devstream.git \u0026\u0026 cd stream go install golang.org/x/tools/cmd/goimports@latest # make sure your GOPATH/bin is in your PATH # for example, run this: export PATH=`go env GOPATH`/bin:$PATH make build # after you run \"make build\", you DO NOT need to run \"dtm init\" anymore # run \"dtm apply\", \"dtm delete\" directly # because \"init\" will try to download plugins from the internet, # instead of using what you just built dtm apply -f path_to_your_config.yaml Want More? Congratulations if you have followed so far. Why not go the extra mile by creating a new plugin of your own and play with it?\nEach plugin needs to implement four interfaces, defined as follows:\nCreate Read Update Delete Refer to an existing plugin for more detail. For example, this one.\nI know, I know, before you complain, let me tell you this: due to the nature that each plugin is in fact a separate thing from others, there will be some duplicated scaffolding, copying, and pasting when you try to create a new plugin.\nEXCEPT I WON’T ALLOW IT TO HAPPEN.\nGood news! We created a tool to make it a whole lot easier for you. NO COPY-PASTE. Run:\ndtm develop create-plugin --name=my-pluing-name-here and we will bootstrap the required code, files, and directory structure for you. How about that? Happy hacking, buddy!\nIf you enjoy reading this post, please like, comment, and subscribe! I will see you next time.\n","wordCount":"1327","inLanguage":"en","image":"https://www.guotiexin.com/donganlake.jpg","datePublished":"2022-03-21T00:00:00Z","dateModified":"2022-03-21T00:00:00Z","author":{"@type":"Person","name":"Tiexin Guo | 郭铁心"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.guotiexin.com/posts/hello-world/"},"publisher":{"@type":"Organization","name":"Tiexin Guo","logo":{"@type":"ImageObject","url":"https://www.guotiexin.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.guotiexin.com accesskey=h title="Tiexin Guo (Alt + H)">Tiexin Guo</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.guotiexin.com/about title=About><span>About</span></a></li><li><a href=https://cv.guotiexin.com/ title=CV><span>CV</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.guotiexin.com/portfolio title=Portfolio><span>Portfolio</span></a></li><li><a href=https://www.guotiexin.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://www.guotiexin.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.guotiexin.com/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://github.com/ironcore864 title><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Hello, World!</h1><div class=post-meta><span title='2022-03-21 00:00:00 +0000 UTC'>March 21, 2022</span>&nbsp;·&nbsp;Tiexin Guo | 郭铁心</div></header><figure class=entry-cover><img loading=lazy srcset="https://www.guotiexin.com/posts/hello-world/donganlake_hu39a3bd16570600ecdb6763b7946784a6_157102_360x0_resize_q75_box.jpg 360w ,https://www.guotiexin.com/posts/hello-world/donganlake_hu39a3bd16570600ecdb6763b7946784a6_157102_480x0_resize_q75_box.jpg 480w ,https://www.guotiexin.com/posts/hello-world/donganlake_hu39a3bd16570600ecdb6763b7946784a6_157102_720x0_resize_q75_box.jpg 720w ,https://www.guotiexin.com/posts/hello-world/donganlake_hu39a3bd16570600ecdb6763b7946784a6_157102_1080x0_resize_q75_box.jpg 1080w ,https://www.guotiexin.com/posts/hello-world/donganlake.jpg 1200w" sizes="(min-width: 768px) 720px, 100vw" src=https://www.guotiexin.com/posts/hello-world/donganlake.jpg alt="dong'an lake" width=1200 height=800></figure><div class=post-content><p>Hello, and welcome to the DevStream blog!</p><p>In this very first &ldquo;hello world&rdquo; post, I will:</p><ul><li>give you a high-level picture of how DevStream functions;</li><li>walk you through our codebase;</li><li>explain briefly how to create your own plugin.</li></ul><p>If you haven&rsquo;t heard of DevStream yet, please have a quick glance over our <a href=https://github.com/devstream-io/devstream>README</a>.</p><p>Without further adieu, let&rsquo;s get started.</p><hr><h2 id=tldr>TL;DR<a hidden class=anchor aria-hidden=true href=#tldr>#</a></h2><p>Too bad, there isn&rsquo;t one. But don&rsquo;t close the tab right away; let me tell you a story.</p><p>Most of the time, I&rsquo;m a &ldquo;normal&rdquo; end-user. And by &ldquo;normal&rdquo;, I mean I don&rsquo;t bother myself with creating GitHub issues and pull requests and follow the updates for days (if not weeks). I love and use open-source projects, but that&rsquo;s about it. Perhaps when I&rsquo;m in an extremely good (or bad) mood, I will open up a discussion to give some feedback (or WTFs) and ramble about it. I don&rsquo;t really contribute on a daily basis, though. Don&rsquo;t get me wrong: I&rsquo;d love it if I had more time; but I work a 9-to-5 job to live, just like most of the readers do.</p><p>If you are like me, should you read this post anyway?</p><p>Well, yes. Because although this article is about DevStream, it isn&rsquo;t. We will cover quite some topics that are non-specific to DevStream. We will discuss generic topics about <a href="https://en.wikipedia.org/wiki/42_(number)#The_Hitchhiker's_Guide_to_the_Galaxy">life, the universe, and everything</a>. Hang tight. Here we go.</p><hr><h2 id=criticism-wanted>Criticism Wanted<a hidden class=anchor aria-hidden=true href=#criticism-wanted>#</a></h2><p><a href=https://www.producthunt.com/posts/devstream-1>We released early (Mar 2nd, 2022.)</a> Maybe a little bit too early, one would say. We weren&rsquo;t in stealth mode for long; 8 weeks, tops.</p><p>Of course, that wasn&rsquo;t a mistake. We didn&rsquo;t accidentally click the &ldquo;publish&rdquo; button on Product Hunt and leak it out. We did this pretty much on purpose. In fact, even before our version 0.1 was released, we had already decided to aim for an early release. It&rsquo;s pretty much by design. Since it&rsquo;s still early and immature, <em>there might be bugs.</em> I know you probably want to swear already, but bear with me:</p><p>I mean, technically, we could work on it for a much longer period, polish it up, add more features, support more tools, and what have you. But in that case, we might end up with something <em>we</em> thought is perfect but utterly useless to <em>you</em>, which is what really matters.</p><p>All we had was an idea. We didn&rsquo;t know &ldquo;how&rdquo;, or even &ldquo;what&rdquo;. All we knew is, we wanted to build something that is useful for the end-users. So why not release it to the users and ask them to tell us what to build and how to build?</p><p>The idea isn&rsquo;t mine, though. It would be arrogant if I said that I invented that. In fact, I learned it from lean manufacturing and agile development. To be honest, if I learned only one thing from lean manufacturing and agile, it&rsquo;s that we should reduce the product-to-customer cycle. It&rsquo;s <a href=https://en.wikipedia.org/wiki/The_Toyota_Way>The Toyota Way</a>.</p><p>OK, enough rambling. If you are interested in DevStream, simply go to our <a href=https://github.com/devstream-io/devstream>GitHub repo</a>, follow our README and quickstart, and have a go. I&rsquo;m sure you will have some &ldquo;WTF&rdquo; moments during your first try, in which case, don&rsquo;t hesitate to head to our <a href=https://github.com/devstream-io/devstream/issues>GitHub Issues page</a> and hit the &ldquo;New Issue&rdquo; button hard. We have prepared a few templates there to help you quickly get your dissatisfaction out of your system. Heck, you can even create an issue about the issue templates themselves. For helpful contributions, we will give you a &ldquo;good first issue&rdquo; label and who knows, probably the marketing team will reach out and award you with a little physical prize as well!</p><hr><h2 id=intrigued>Intrigued?<a hidden class=anchor aria-hidden=true href=#intrigued>#</a></h2><p>Then let&rsquo;s dive a little deeper into it.</p><h3 id=architecture>Architecture<a hidden class=anchor aria-hidden=true href=#architecture>#</a></h3><p>A picture is worth a thousand words:</p><p><img loading=lazy src=./architecture-overview.png alt=architecture-overview></p><p>We use the <a href=https://pkg.go.dev/plugin>Go plugin</a>. I know this is kind of a big topic so here I&rsquo;m only going to talk about it briefly:</p><ul><li>First of all, we want to support many DevOps tools, and one tool corresponding to one plugin sounds natural.</li><li>Second of all, although there are other ways to do the &ldquo;core-plugin&rdquo; architecture, we reviewed Go&rsquo;s plugin and it met our needs.</li><li>Oops, I thought there was a &ldquo;third&rdquo; or &ldquo;last but not least&rdquo;, but there isn&rsquo;t. Sorry.</li></ul><h3 id=state>State<a hidden class=anchor aria-hidden=true href=#state>#</a></h3><p>We consider DevStream (CLI tool <code>dtm</code>, don&rsquo;t ask me why; it&rsquo;s another whole story. Read <a href=https://github.com/devstream-io/devstream#why-dtm>this</a> if you enjoy stories) as a &ldquo;<a href=https://en.wikipedia.org/wiki/Finite-state_machine>state machine</a>&rdquo;.</p><p>Simply put, given input and the current state, DevStream will calculate what to do, so that &ldquo;what you want&rdquo; (what you described in the input) is &ldquo;what you get&rdquo;.</p><p>If you are interested, read more <a href=https://github.com/devstream-io/devstream/blob/main/docs/core_concept.md>here</a>.</p><h3 id=directory-structure>Directory structure<a hidden class=anchor aria-hidden=true href=#directory-structure>#</a></h3><p>We follow Golang&rsquo;s <a href=https://github.com/golang-standards/project-layout>standard project layout</a>. But don&rsquo;t click that link, it&rsquo;s too long and too verbose and contains probably many things you don&rsquo;t immediately need right now. Continue to read the TL;DR version:</p><ul><li><code>/cmd</code>: main applications for this project. <em>Don&rsquo;t put a lot of code in the application directory. If you think the code can be imported and used in other projects, then it should live in the <code>/pkg</code> directory. If the code is not reusable or if you don&rsquo;t want others to reuse it, put that code in the <code>/internal</code> directory.</em></li><li><code>/pkg</code>: library code that&rsquo;s ok to use by external apps. <em>Other projects will import these libs expecting them to work, so think twice before you put something here.</em></li><li><code>/internal</code>: private application and library code; things you don&rsquo;t want others to import in their own apps.</li><li><code>/hack</code>: contains many scripts that ensure continuous development of DevStream. We didn&rsquo;t invent this; we simply stole <a href=https://github.com/kubernetes/kubernetes/tree/master/hack>Kubernetes&rsquo; idea</a>.</li><li><code>/build</code>: packaging and CI-related stuff.</li><li><code>/docs</code>: pretty much self-explanatory. Need I say more?</li><li><code>/examples</code>: examples for your apps or public libs. Here we use it to store some sample configurations.</li></ul><p>Of course, this isn&rsquo;t the only way to set up a repo structure for a Golang app. If you are a beginner, though, this can save you some time. For example, after reading this, you should know that if you want to find the entrance of the app, you shall look into the <code>cmd</code> folder. That&rsquo;s where the main app lives.</p><h3 id=core--plugin>Core / Plugin<a hidden class=anchor aria-hidden=true href=#core--plugin>#</a></h3><ul><li>Core code: <a href=https://github.com/devstream-io/devstream/tree/main/internal/pkg/pluginengine>https://github.com/devstream-io/devstream/tree/main/internal/pkg/pluginengine</a></li><li>Plugins Code: <a href=https://github.com/devstream-io/devstream/tree/main/internal/pkg/plugin>https://github.com/devstream-io/devstream/tree/main/internal/pkg/plugin</a></li></ul><h3 id=how-exactly-does-dtm-apply-work-is-it-automatic-or-automagic>How Exactly Does <code>dtm apply</code> Work? Is it &ldquo;Automatic&rdquo;, or &ldquo;Automagic&rdquo;?<a hidden class=anchor aria-hidden=true href=#how-exactly-does-dtm-apply-work-is-it-automatic-or-automagic>#</a></h3><ol><li>It all starts with <a href=https://github.com/devstream-io/devstream/blob/main/cmd/devstream/main.go><code>/cmd/devstream/main.go</code></a>.</li><li>It executes the <code>apply</code> command in <a href=https://github.com/devstream-io/devstream/blob/main/cmd/devstream/apply.go><code>/cmd/devstream/apply.go</code></a>.</li><li>The <em>Engine</em> <a href=https://github.com/devstream-io/devstream/tree/main/internal/pkg/pluginengine><code>/internal/pkg/pluginengine</code></a> runs the logic for <code>apply</code> at <a href=https://github.com/devstream-io/devstream/blob/main/internal/pkg/pluginengine/cmd_apply.go><code>/internal/pkg/pluginengine/cmd_apply.go</code></a>.</li></ol><p>Then, happy digging around in the &ldquo;Apply&rdquo; function!</p><hr><h2 id=you-release-waaaaay-too-slow-i-want-the-latest-stuff-now>You Release Waaaaay Too Slow! I WANT THE LATEST STUFF!! NOW!!!<a hidden class=anchor aria-hidden=true href=#you-release-waaaaay-too-slow-i-want-the-latest-stuff-now>#</a></h2><p>Alright, alright, here you go.</p><p>First, install Go. If you haven&rsquo;t done so, please refer to the <a href=https://go.dev/doc/install>official doc here</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/devstream-io/devstream.git <span class=o>&amp;&amp;</span> <span class=nb>cd</span> stream
</span></span><span class=line><span class=cl>go install golang.org/x/tools/cmd/goimports@latest
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># make sure your GOPATH/bin is in your PATH</span>
</span></span><span class=line><span class=cl><span class=c1># for example, run this:</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=sb>`</span>go env GOPATH<span class=sb>`</span>/bin:<span class=nv>$PATH</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>make build
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># after you run &#34;make build&#34;, you DO NOT need to run &#34;dtm init&#34; anymore</span>
</span></span><span class=line><span class=cl><span class=c1># run &#34;dtm apply&#34;, &#34;dtm delete&#34; directly</span>
</span></span><span class=line><span class=cl><span class=c1># because &#34;init&#34; will try to download plugins from the internet,</span>
</span></span><span class=line><span class=cl><span class=c1># instead of using what you just built</span>
</span></span><span class=line><span class=cl>dtm apply -f path_to_your_config.yaml
</span></span></code></pre></div><hr><h2 id=want-more>Want More?<a hidden class=anchor aria-hidden=true href=#want-more>#</a></h2><p>Congratulations if you have followed so far. Why not go the extra mile by creating a new plugin of your own and play with it?</p><p>Each plugin needs to implement four interfaces, defined as follows:</p><ul><li><a href=https://github.com/devstream-io/devstream/blob/main/internal/pkg/pluginengine/plugin.go#L12><code>Create</code></a></li><li><a href=https://github.com/devstream-io/devstream/blob/main/internal/pkg/pluginengine/plugin.go#L13><code>Read</code></a></li><li><a href=https://github.com/devstream-io/devstream/blob/main/internal/pkg/pluginengine/plugin.go#L14><code>Update</code></a></li><li><a href=https://github.com/devstream-io/devstream/blob/main/internal/pkg/pluginengine/plugin.go#L16><code>Delete</code></a></li></ul><p>Refer to an existing plugin for more detail. For example, <a href=https://github.com/devstream-io/devstream/blob/main/cmd/argocd/main.go>this one</a>.</p><p>I know, I know, before you complain, let me tell you this: due to the nature that each plugin is in fact a separate thing from others, there will be some duplicated scaffolding, copying, and pasting when you try to create a new plugin.</p><p>EXCEPT I WON&rsquo;T ALLOW IT TO HAPPEN.</p><p>Good news! We created a tool to make it a whole lot easier for you. NO COPY-PASTE. Run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dtm develop create-plugin --name<span class=o>=</span>my-pluing-name-here
</span></span></code></pre></div><p>and we will bootstrap the required code, files, and directory structure for you. How about that? Happy hacking, buddy!</p><p>If you enjoy reading this post, please like, comment, and subscribe! I will see you next time.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.guotiexin.com/tags/devstream/>devstream</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://www.guotiexin.com>Tiexin Guo</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>