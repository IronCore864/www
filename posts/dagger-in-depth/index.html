<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Dagger (the CI/CD Tool, not the Knife) In-Depth - Everything You Need to Know (as of Apr 2022) | Tiexin Guo</title><meta name=keywords content="ci,devops"><meta name=description content="1 What is Dagger? TL;DR: Dagger runs your CI/CD pipelines locally in a Docker container, and can run the container in any CI environment (as long as that CI can run a container, of course.) Do you want the long answer to this million-dollar question? It&rsquo;s hard to answer, honestly. News is calling it a &ldquo;DevOps platform&rdquo;; the VC that funded Dagger even called it a &ldquo;DevOps operating system.&rdquo; But,"><meta name=author content="Tiexin Guo | 郭铁心"><link rel=canonical href=https://www.guotiexin.com/posts/dagger-in-depth/><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://www.guotiexin.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.guotiexin.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.guotiexin.com/favicon-32x32.png><link rel=apple-touch-icon href=https://www.guotiexin.com/apple-touch-icon.png><link rel=mask-icon href=https://www.guotiexin.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Dagger (the CI/CD Tool, not the Knife) In-Depth - Everything You Need to Know (as of Apr 2022)"><meta property="og:description" content="1 What is Dagger? TL;DR: Dagger runs your CI/CD pipelines locally in a Docker container, and can run the container in any CI environment (as long as that CI can run a container, of course.) Do you want the long answer to this million-dollar question? It&rsquo;s hard to answer, honestly. News is calling it a &ldquo;DevOps platform&rdquo;; the VC that funded Dagger even called it a &ldquo;DevOps operating system.&rdquo; But,"><meta property="og:type" content="article"><meta property="og:url" content="https://www.guotiexin.com/posts/dagger-in-depth/"><meta property="og:image" content="https://www.guotiexin.com/banner.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-12T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-12T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.guotiexin.com/banner.jpg"><meta name=twitter:title content="Dagger (the CI/CD Tool, not the Knife) In-Depth - Everything You Need to Know (as of Apr 2022)"><meta name=twitter:description content="1 What is Dagger? TL;DR: Dagger runs your CI/CD pipelines locally in a Docker container, and can run the container in any CI environment (as long as that CI can run a container, of course.) Do you want the long answer to this million-dollar question? It&rsquo;s hard to answer, honestly. News is calling it a &ldquo;DevOps platform&rdquo;; the VC that funded Dagger even called it a &ldquo;DevOps operating system.&rdquo; But,"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://www.guotiexin.com/posts/"},{"@type":"ListItem","position":3,"name":"Dagger (the CI/CD Tool, not the Knife) In-Depth - Everything You Need to Know (as of Apr 2022)","item":"https://www.guotiexin.com/posts/dagger-in-depth/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Dagger (the CI/CD Tool, not the Knife) In-Depth - Everything You Need to Know (as of Apr 2022)","name":"Dagger (the CI\/CD Tool, not the Knife) In-Depth - Everything You Need to Know (as of Apr 2022)","description":"1 What is Dagger? TL;DR: Dagger runs your CI/CD pipelines locally in a Docker container, and can run the container in any CI environment (as long as that CI can run a container, of course.) Do you want the long answer to this million-dollar question? It\u0026rsquo;s hard to answer, honestly. News is calling it a \u0026ldquo;DevOps platform\u0026rdquo;; the VC that funded Dagger even called it a \u0026ldquo;DevOps operating system.\u0026rdquo; But,","keywords":["ci","devops"],"articleBody":"1 What is Dagger? TL;DR: Dagger runs your CI/CD pipelines locally in a Docker container, and can run the container in any CI environment (as long as that CI can run a container, of course.)\nDo you want the long answer to this million-dollar question? It’s hard to answer, honestly. News is calling it a “DevOps platform”; the VC that funded Dagger even called it a “DevOps operating system.”\nBut, in fact, Dagger is neither of those things.\nBefore we can answer what Dagger is, let’s have a look at it in-depth:\n2 Quirks and Features 2.1 BuildKit In Dagger, the configuration is executed in BuildKit, which is the execution engine at the heart of Docker.\nBuildKit was developed as part of the Moby project, the latter of which is an open framework to assemble specialized container systems without reinventing the wheel by Docker. Basically, it’s a toolkit for converting source code to build artifacts in an efficient, expressive, and repeatable manner. It was announced in 2017 and began shipping with Docker Engine in 2018’s version 18.09.\n2.2 CUE Unlike most popular CI systems out there, you don’t write YAML in Dagger; you write CUE.\nI feel you because I didn’t know what’s CUE either. Turned out, CUE is an open-source data validation language and inference engine with its roots in logic programming.\nIt aims to simplify tasks involving defining and using data. It’s actually a superset of JSON, so users familiar with JSON should feel comfortable with it already and can get started quickly. It also has got built-in auto-formatting (yay.)\nAlthough the language is not a general-purpose programming language, it has many applications, such as data validation, data templating, configuration (that’s probably why Dagger decided to use it in the first place), querying, code generation, and even scripting.\n2.3 Wait a Minute Since it’s already reusing Docker’s parts for configuration execution, why not reuse Docker’s other part, Dockerfile, for configuration?\nWhat’s the purpose of using another language just for the configuration?\nSolomon Hykes, the founder of Dagger, actually answered exact this question on their official Discord channel:\nWe needed a modern declarative language with a type system, a package manager, native yaml and json interop, a formal spec, and a standalone community not locked to one tool.\nAlso Dockerfiles are specific to build, but Dagger is more general-purpose automation\nThere was no way at all Dockerfile could support our requirements (speaking as one of the original authors of the Dockerfile syntax)\n3 Enough Tech Spec. What Does Dagger Do? 3.1 What Dagger Isn’t First, let me tell you what Dagger isn’t by quoting the official documentation:\nDagger does not replace your CI: it improves it by adding a portable development layer on top of it.\nOK, so it’s not yet another CI (or CD, for that matter).\nDagger didn’t even try to replace your existing CI, at all. But rather, it improves your CI, by adding a wrapper layer.\nI know the term “wrapper” doesn’t sound fancy, so let’s call it by its official reference, and that is “portable development layer”.\n3.2 So, Just a Wrapper? Disappointed? Don’t conclude too quick; follow me. First, let’s look at some other DevOps/cloud related examples:\nThink of Terraform. You’ve got multiple environments to manage. Even with reuseable modules and roles, you still have duplicated code across envs. Then comes Terragrunt, which is a (thin) wrapper that provides extra tools for keeping your configurations simple without repeating yourself. Think of AWS CDK. It actually is a wrapper layer on top of CloudFormation, which lets you use your familiar programming languages to define and provision AWS cloud infrastructure, so that you don’t have to deal with CloudFormation’s non-human-readable configurations. Of course, your code still converts to a format that CloudFormation understands, and your infrastructure is still managed by CloudFormation; AWS CDK doesn’t really interact with AWS APIs directly. That’s why it’s only a wrapper layer on top of CloudFormation. Think of CDKTF (CDK for Terraform); it’s no different than AWS CDK, perhaps because CDKTF is inspired by AWS CDK and also uses AWS’s jsii library to be polyglot. It’s a wrapper layer on top of Terraform that translates your code into Terraform HCL so that you don’t have to learn HCL. But in essence, your infrastructure is still managed by Terraform HCL, not your code directly. So, it’s yet another wrapper. You must have already figured out where I am going with this, and you are right: yes, Dagger is no different. It is a wrapper.\nBut, of course, the wrapper has to do something to be useful, right? Then what exactly does Dagger do? What exactly does Dagger wrap? Good Questions.\n3.3 What Dagger Can Do In any CI system, you define some steps and actions in a certain format (YAML, most likely) and run it in your CI system. For example, in Jenkins, maybe you will write some groovy file. In GitHub Actions, you write some YAML with multiple steps.\nBasically, Dagger runs those “steps and actions” in a Docker container. Then where do you run the Dagger docker container itself? Great question: you can either run it locally (because you can install Docker desktop, right?) or in your existing CI (since most CIs can run a docker container.)\nIf you think about it: Dagger doesn’t wrap your CI pipelines or systems. It wraps those detailed steps and actions into a Docker container and still runs in your existing CI. It’s like writing a big Dockerfile, and when you run the container, it does git clone, source code static scan, test, build, artifact upload, and what have you.\n4 What Dagger Really Is Yes, Dagger is a wrapper, that part is true.\nBut, it doesn’t wrap CI systems; it wraps your pipeline steps and actions into a container (you have to rewrite those steps and actions in Dagger’s syntax, though), and the wrapped result can run in another CI (as long as that CI can run a container.)\nIn this sense, Dagger is yet another CI, except that CI runs in a container and most CI systems happen to be able to run containers.\n5 Benefits I think there are 3 major advantages of using Dagger\n5.1 Local Development Firstly, there is no need to install any dependencies specific to this application, because Dagger manages all the intermediate steps and transient dependencies inside the Docker container.\nThis might not be an advantage if we are talking about CI, but it is an advantage if we are talking about local development.\nThink of Go where you have to install modules or think of Nodejs where you might even need to switch Node versions then do an NPM install. Now you can do all of those inside a container and only get the final result to your local laptop.\n5.2 “On-Premise” CI You can run your pipeline locally now since you can easily have the Docker desktop up and running locally.\nI’m not sure if this is a solid requirement, though. Maybe it is? Because we all have powerful laptops now; why waste money on some CI systems when you can run them locally?\nThe idea of running it anywhere as long as Docker is available is intriguing, though. If you don’t want to buy CI as a service, you can run Dagger in your own infrastructure.\n5.3 Migrate to Another CI Since your “steps and actions” now are running in a container, you can run it elsewhere, in another CI system.\nShould you need to migrate to another CI, you do not need to rewrite your CI steps anymore. For example, you don’t want to use your company’s old Jenkins instance anymore, but you are already using Dagger with Jenkins, and now you want to give GitHub Actions a try.\nIt’s worth noting that in this scenario, there are still two things to do:\nIf you are using Jenkins now, and want to migrate those Jenkins pipelines into Dagger, you need to do it manually. The cost is the same (if not more) as rewriting your whole pipeline in GitHub Actions’ syntax. You will still need to learn about your new CI system: how a job is triggered, the syntax, etc. Here you can see Dagger does provide a solution to avoid CI lock-in (to some extent.) But it is not a game changing solution that could resolve your flexibility concern.\nFor a DevOps engineer, a DevOps toolchain that could accommodate different needs and priorities from different teams is more than appealing. That being said, each component is modular and pluggable, and you could free yourself from tedious work like launching, integrating, and managing all these pieces.\nIdeally, you could define your desired DevOps tools in a single human-readable YAML config file, and with one single command, you have your whole DevOps toolchain and SDLC workflow set up or changed.\nIf you are intrigued by the simplicity of “DevOps toolchain as code”, don’t hesitate to check out DevStream here.\n6 Should I use Dagger Now? Is it promising? Maybe. Should I start using it now? My answer is No. Three reasons:\nThe Dagger project itself still uses GitHub Actions. Why? Probably because it has limitations and can’t do everything you can achieve with GitHub Actions. You probably won’t change your CI system every 6 months. If you only change it one time in 4 years, why bother adding that wrapper? Dagger is only recently announced. It hasn’t supported a whole lot of CI systems yet. Maybe the CI you want to switch to doesn’t support it yet. Like, comment, subscribe. See you in the next article!\n","wordCount":"1609","inLanguage":"en","image":"https://www.guotiexin.com/banner.jpg","datePublished":"2022-04-12T00:00:00Z","dateModified":"2022-04-12T00:00:00Z","author":{"@type":"Person","name":"Tiexin Guo | 郭铁心"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.guotiexin.com/posts/dagger-in-depth/"},"publisher":{"@type":"Organization","name":"Tiexin Guo","logo":{"@type":"ImageObject","url":"https://www.guotiexin.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://www.guotiexin.com accesskey=h title="Tiexin Guo (Alt + H)">Tiexin Guo</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://www.guotiexin.com/about title=About><span>About</span></a></li><li><a href=https://cv.guotiexin.com/ title=CV><span>CV</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://www.guotiexin.com/portfolio title=Portfolio><span>Portfolio</span></a></li><li><a href=https://www.guotiexin.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://www.guotiexin.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://www.guotiexin.com/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://github.com/ironcore864 title><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Dagger (the CI/CD Tool, not the Knife) In-Depth - Everything You Need to Know (as of Apr 2022)</h1><div class=post-meta><span title='2022-04-12 00:00:00 +0000 UTC'>April 12, 2022</span>&nbsp;·&nbsp;Tiexin Guo | 郭铁心</div></header><figure class=entry-cover><img loading=lazy srcset="https://www.guotiexin.com/posts/dagger-in-depth/banner_huf55cda8a75fa1a259fb0aa4bf1976872_76029_360x0_resize_q75_box.jpg 360w ,https://www.guotiexin.com/posts/dagger-in-depth/banner_huf55cda8a75fa1a259fb0aa4bf1976872_76029_480x0_resize_q75_box.jpg 480w ,https://www.guotiexin.com/posts/dagger-in-depth/banner_huf55cda8a75fa1a259fb0aa4bf1976872_76029_720x0_resize_q75_box.jpg 720w ,https://www.guotiexin.com/posts/dagger-in-depth/banner_huf55cda8a75fa1a259fb0aa4bf1976872_76029_1080x0_resize_q75_box.jpg 1080w ,https://www.guotiexin.com/posts/dagger-in-depth/banner.jpg 1200w" sizes="(min-width: 768px) 720px, 100vw" src=https://www.guotiexin.com/posts/dagger-in-depth/banner.jpg alt=chongqing width=1200 height=800></figure><div class=post-content><h2 id=1-what-is-dagger>1 What is Dagger?<a hidden class=anchor aria-hidden=true href=#1-what-is-dagger>#</a></h2><p>TL;DR: Dagger runs your CI/CD pipelines locally in a Docker container, and can run the container in any CI environment (as long as that CI can run a container, of course.)</p><p>Do you want the long answer to this million-dollar question? It&rsquo;s hard to answer, honestly. News is calling it a &ldquo;DevOps platform&rdquo;; the VC that funded Dagger even called it a &ldquo;DevOps operating system.&rdquo;</p><p>But, in fact, Dagger is neither of those things.</p><p>Before we can answer what Dagger is, let&rsquo;s have a look at it in-depth:</p><h2 id=2-quirks-and-features>2 Quirks and Features<a hidden class=anchor aria-hidden=true href=#2-quirks-and-features>#</a></h2><h3 id=21-buildkit>2.1 BuildKit<a hidden class=anchor aria-hidden=true href=#21-buildkit>#</a></h3><p>In Dagger, the configuration is executed in BuildKit, which is the execution engine at the heart of Docker.</p><p>BuildKit was developed as part of the Moby project, the latter of which is an open framework to assemble specialized container systems without reinventing the wheel by Docker. Basically, it&rsquo;s a toolkit for converting source code to build artifacts in an efficient, expressive, and repeatable manner. It was announced in 2017 and began shipping with Docker Engine in 2018’s version 18.09.</p><h3 id=22-cue>2.2 CUE<a hidden class=anchor aria-hidden=true href=#22-cue>#</a></h3><p>Unlike most popular CI systems out there, you don&rsquo;t write YAML in Dagger; you write CUE.</p><p>I feel you because I didn&rsquo;t know what&rsquo;s CUE either. Turned out, CUE is an open-source data validation language and inference engine with its roots in logic programming.</p><p>It aims to simplify tasks involving defining and using data. It&rsquo;s actually a superset of JSON, so users familiar with JSON should feel comfortable with it already and can get started quickly. It also has got built-in auto-formatting (yay.)</p><p>Although the language is not a general-purpose programming language, it has many applications, such as data validation, data templating, configuration (that&rsquo;s probably why Dagger decided to use it in the first place), querying, code generation, and even scripting.</p><h3 id=23-wait-a-minute>2.3 Wait a Minute<a hidden class=anchor aria-hidden=true href=#23-wait-a-minute>#</a></h3><p>Since it&rsquo;s already reusing Docker&rsquo;s parts for configuration execution, why not reuse Docker&rsquo;s other part, Dockerfile, for configuration?</p><p>What&rsquo;s the purpose of using another language just for the configuration?</p><p>Solomon Hykes, the founder of Dagger, actually answered exact this question on their official Discord channel:</p><blockquote><p>We needed a modern declarative language with a type system, a package manager, native yaml and json interop, a formal spec, and a standalone community not locked to one tool.</p><p>Also Dockerfiles are specific to build, but Dagger is more general-purpose automation</p><p>There was no way at all Dockerfile could support our requirements (speaking as one of the original authors of the Dockerfile syntax)</p></blockquote><h2 id=3-enough-tech-spec-what-does-dagger-do>3 Enough Tech Spec. What Does Dagger Do?<a hidden class=anchor aria-hidden=true href=#3-enough-tech-spec-what-does-dagger-do>#</a></h2><h3 id=31-what-dagger-isnt>3.1 What Dagger Isn&rsquo;t<a hidden class=anchor aria-hidden=true href=#31-what-dagger-isnt>#</a></h3><p>First, let me tell you what Dagger isn&rsquo;t by quoting the official documentation:</p><blockquote><p>Dagger does not replace your CI: it improves it by adding a portable development layer on top of it.</p></blockquote><p>OK, so it&rsquo;s not yet another CI (or CD, for that matter).</p><p>Dagger didn&rsquo;t even try to <em>replace</em> your existing CI, at all. But rather, it <em>improves</em> your CI, by adding a wrapper layer.</p><p>I know the term &ldquo;wrapper&rdquo; doesn&rsquo;t sound fancy, so let&rsquo;s call it by its official reference, and that is &ldquo;portable development layer&rdquo;.</p><h3 id=32-so-just-a-wrapper>3.2 So, Just a Wrapper?<a hidden class=anchor aria-hidden=true href=#32-so-just-a-wrapper>#</a></h3><p>Disappointed? Don&rsquo;t conclude too quick; follow me. First, let&rsquo;s look at some other DevOps/cloud related examples:</p><ul><li>Think of Terraform. You&rsquo;ve got multiple environments to manage. Even with reuseable modules and roles, you still have duplicated code across envs. Then comes Terragrunt, which is a (thin) wrapper that provides extra tools for keeping your configurations simple without repeating yourself.</li><li>Think of AWS CDK. It actually is a wrapper layer on top of CloudFormation, which lets you use your familiar programming languages to define and provision AWS cloud infrastructure, so that you don&rsquo;t have to deal with CloudFormation&rsquo;s non-human-readable configurations. Of course, your code still converts to a format that CloudFormation understands, and your infrastructure is still managed by CloudFormation; AWS CDK doesn&rsquo;t really interact with AWS APIs directly. That&rsquo;s why it&rsquo;s only a wrapper layer on top of CloudFormation.</li><li>Think of CDKTF (CDK for Terraform); it&rsquo;s no different than AWS CDK, perhaps because CDKTF is inspired by AWS CDK and also uses AWS&rsquo;s <code>jsii</code> library to be polyglot. It&rsquo;s a wrapper layer on top of Terraform that translates your code into Terraform HCL so that you don&rsquo;t have to learn HCL. But in essence, your infrastructure is still managed by Terraform HCL, not your code directly. So, it&rsquo;s yet another wrapper.</li></ul><p>You must have already figured out where I am going with this, and you are right: yes, Dagger is no different. It is a wrapper.</p><p>But, of course, the wrapper has to do something to be useful, right? Then what exactly does Dagger do? What exactly does Dagger wrap? Good Questions.</p><h3 id=33-what-dagger-can-do>3.3 What Dagger Can Do<a hidden class=anchor aria-hidden=true href=#33-what-dagger-can-do>#</a></h3><p>In any CI system, you define some steps and actions in a certain format (YAML, most likely) and run it in your CI system. For example, in Jenkins, maybe you will write some groovy file. In GitHub Actions, you write some YAML with multiple steps.</p><p>Basically, Dagger runs those &ldquo;steps and actions&rdquo; in a Docker container. Then where do you run the Dagger docker container itself? Great question: you can either run it locally (because you can install Docker desktop, right?) or in your existing CI (since most CIs can run a docker container.)</p><p>If you think about it: Dagger doesn&rsquo;t wrap your CI pipelines or systems. It wraps those detailed steps and actions into a Docker container and still runs in your existing CI. It&rsquo;s like writing a big Dockerfile, and when you run the container, it does git clone, source code static scan, test, build, artifact upload, and what have you.</p><h2 id=4-what-dagger-really-is>4 What Dagger Really Is<a hidden class=anchor aria-hidden=true href=#4-what-dagger-really-is>#</a></h2><p>Yes, Dagger is a wrapper, that part is true.</p><p>But, it doesn&rsquo;t wrap CI systems; it wraps your pipeline steps and actions into a container (you have to rewrite those steps and actions in Dagger&rsquo;s syntax, though), and the wrapped result can run in another CI (as long as that CI can run a container.)</p><p>In this sense, Dagger <em>is</em> yet another CI, except that CI runs in a container and most CI systems happen to be able to run containers.</p><h2 id=5-benefits>5 Benefits<a hidden class=anchor aria-hidden=true href=#5-benefits>#</a></h2><p>I think there are 3 major advantages of using Dagger</p><h3 id=51-local-development>5.1 Local Development<a hidden class=anchor aria-hidden=true href=#51-local-development>#</a></h3><p>Firstly, there is no need to install <em>any</em> dependencies specific to this application, because Dagger manages all the intermediate steps and transient dependencies inside the Docker container.</p><p>This might not be an advantage if we are talking about CI, but it is an advantage if we are talking about local development.</p><p>Think of Go where you have to install modules or think of Nodejs where you might even need to switch Node versions then do an NPM install. Now you can do all of those inside a container and only get the final result to your local laptop.</p><h3 id=52-on-premise-ci>5.2 &ldquo;On-Premise&rdquo; CI<a hidden class=anchor aria-hidden=true href=#52-on-premise-ci>#</a></h3><p>You can run your pipeline locally now since you can easily have the Docker desktop up and running locally.</p><p>I&rsquo;m not sure if this is a solid requirement, though. Maybe it is? Because we all have powerful laptops now; why waste money on some CI systems when you can run them locally?</p><p>The idea of running it anywhere as long as Docker is available is intriguing, though. If you don&rsquo;t want to buy CI as a service, you can run Dagger in your own infrastructure.</p><h3 id=53-migrate-to-another-ci>5.3 Migrate to Another CI<a hidden class=anchor aria-hidden=true href=#53-migrate-to-another-ci>#</a></h3><p>Since your &ldquo;steps and actions&rdquo; now are running in a container, you can run it elsewhere, in another CI system.</p><p>Should you need to migrate to another CI, you do not need to rewrite your CI steps anymore. For example, you don&rsquo;t want to use your company&rsquo;s old Jenkins instance anymore, but you are already using Dagger with Jenkins, and now you want to give GitHub Actions a try.</p><p>It&rsquo;s worth noting that in this scenario, there are still two things to do:</p><ul><li>If you are using Jenkins now, and want to migrate those Jenkins pipelines into Dagger, you need to do it manually. The cost is the same (if not more) as rewriting your whole pipeline in GitHub Actions&rsquo; syntax.</li><li>You will still need to learn about your new CI system: how a job is triggered, the syntax, etc.</li></ul><p>Here you can see Dagger does provide a solution to avoid CI lock-in (to some extent.) But it is not a game changing solution that could resolve your flexibility concern.</p><p>For a DevOps engineer, a DevOps toolchain that could accommodate different needs and priorities from different teams is more than appealing. That being said, each component is modular and pluggable, and you could free yourself from tedious work like launching, integrating, and managing all these pieces.</p><p>Ideally, you could define your desired DevOps tools in a single human-readable YAML config file, and with one single command, you have your whole DevOps toolchain and SDLC workflow set up or changed.</p><p>If you are intrigued by the simplicity of &ldquo;DevOps toolchain as code&rdquo;, don&rsquo;t hesitate to check out DevStream <a href=https://github.com/devstream-io/devstream>here</a>.</p><h2 id=6-should-i-use-dagger-now>6 Should I use Dagger Now?<a hidden class=anchor aria-hidden=true href=#6-should-i-use-dagger-now>#</a></h2><p>Is it promising? Maybe. Should I start using it now? My answer is No. Three reasons:</p><ul><li>The Dagger project itself still uses GitHub Actions. Why? Probably because it has limitations and can&rsquo;t do everything you can achieve with GitHub Actions.</li><li>You probably won&rsquo;t change your CI system every 6 months. If you only change it one time in 4 years, why bother adding that wrapper?</li><li>Dagger is only recently announced. It hasn&rsquo;t supported a whole lot of CI systems yet. Maybe the CI you want to switch to doesn&rsquo;t support it yet.</li></ul><p>Like, comment, subscribe. See you in the next article!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://www.guotiexin.com/tags/ci/>ci</a></li><li><a href=https://www.guotiexin.com/tags/devops/>devops</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://www.guotiexin.com>Tiexin Guo</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>